<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acta de Compromiso Estudiantil</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* (Mantén todos los estilos anteriores igual hasta .signature-section) */

        .signature-section {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
        }

        .signature-box {
            flex: 1;
            min-width: 200px;
            text-align: center;
        }

        .signature-pad {
            width: 100%;
            height: 80px;
            border: 1px solid #ccc;
            background-color: white;
            margin-bottom: 10px;
        }

        /* Asegurar contraste en PDF */
        .container {
            background-color: white !important;
            color: #000 !important;
        }
        textarea, input, select {
            background-color: white !important;
            color: #000 !important;
            border: 1px solid #000 !important;
        }
    </style>
    <!-- Resto del head -->
</head>
<body>
    <!-- (Mantén todo el HTML anterior igual) -->

    <script>
        // Función para descargar PDF (versión corregida)
        async function downloadPDF() {
            if (!validateForm()) return;

            const btn = document.getElementById('download-btn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generando...';
            btn.disabled = true;

            // Forzar estilos para impresión
            const originalStyles = {
                container: document.getElementById('acta-container').style.cssText,
                body: document.body.style.cssText
            };
            
            document.getElementById('acta-container').style.background = 'white';
            document.body.style.background = 'white';

            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Configurar html2canvas para mejor calidad
                const canvas = await html2canvas(document.getElementById('acta-container'), {
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    scrollX: 0,
                    scrollY: 0,
                    backgroundColor: 'white'
                });

                const imgData = canvas.toDataURL('image/png', 1.0);
                const imgWidth = 210; // Ancho A4 en mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;

                pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight, undefined, 'FAST');
                
                // Nombre del archivo
                const studentName = document.getElementById('student-name').value.replace(/\s+/g, '_');
                pdf.save(`Acta_Compromiso_${studentName}.pdf`);

            } catch (error) {
                console.error('Error:', error);
                alert('Error al generar PDF. Por favor usa Chrome o Edge.');
            } finally {
                // Restaurar estilos
                document.getElementById('acta-container').style.cssText = originalStyles.container;
                document.body.style.cssText = originalStyles.body;
                
                btn.innerHTML = '<i class="fas fa-file-pdf"></i> Descargar PDF';
                btn.disabled = false;
            }
        }

        // Configurar firmas idénticas
        function setupSignaturePads() {
            const allPads = document.querySelectorAll('.signature-pad');
            
            allPads.forEach(pad => {
                pad.width = pad.offsetWidth;
                pad.height = 80; // Altura fija
                const ctx = pad.getContext('2d');
                
                // Estilo uniforme
                ctx.strokeStyle = '#000000';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                
                // Eventos (usar los mismos que en el código anterior)
                // ...
            });
        }
    </script>
</body>
</html>
