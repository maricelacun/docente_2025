<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nómina Tercero Informática "B" - U.E. Dr. Camilo Gallegos Domínguez</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Estilo para asegurar que el degradado cubra toda la pantalla y usar la fuente Inter */
        body {
            min-height: 100vh;
            font-family: 'Inter', sans-serif; /* Fuente Inter */
        }
        /* Estilo para la tabla HTML */
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 8px; /* Bordes redondeados para la tabla */
            overflow: hidden; /* Para que los bordes redondeados se apliquen a las celdas */
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px; /* Padding aumentado */
            text-align: left;
            vertical-align: top; /* Alinear texto arriba en celdas */
        }
        th {
            background-color: #4a90e2; /* Azul vibrante para encabezados */
            color: white;
            font-weight: bold; /* Texto en negrita */
        }
        tr:nth-child(even) {
            background-color: #f8f9fa; /* Fondo gris claro para filas pares */
        }
        tr:hover {
            background-color: #e9ecef; /* Efecto hover */
        }
        /* Estilos para botones */
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        /* Estilo para el botón de Excel (verde) */
        .btn-excel {
            background-color: #2ecc71; /* Verde */
            color: white;
        }
        .btn-excel:hover {
            background-color: #27ae60;
            transform: translateY(-2px); /* Efecto hover */
        }
        .btn-print {
            background-color: #3498db; /* Azul */
            color: white;
        }
        .btn-print:hover {
            background-color: #2980b9;
            transform: translateY(-2px); /* Efecto hover */
        }
        /* Clase para degradado radial */
        .bg-radial-gradient-blue-yellow {
             /* Degradado radial de Azul a Amarillo */
             background: radial-gradient(ellipse at center, #60a5fa, #fef08a);
        }
        /* Estilos para impresión: Ocultar botones */
        @media print {
            body {
                background: none; /* Sin fondo al imprimir */
                font-size: 10pt; /* Tamaño de fuente base para impresión */
            }
            .no-print {
                display: none; /* Oculta elementos con esta clase al imprimir */
            }
            .printable-content {
                box-shadow: none; /* Sin sombra al imprimir */
                width: 100%;
                max-width: 100%;
                padding: 0;
                margin: 0;
                background-color: white; /* Fondo blanco */
                color: black; /* Texto negro */
            }
            table {
                box-shadow: none;
                border-radius: 0;
                font-size: 9pt; /* Fuente más pequeña para la tabla en impresión */
            }
            th, td {
                padding: 4px; /* Menos padding en impresión */
                border: 1px solid #ccc; /* Borde más claro */
            }
            th {
                 background-color: #eee; /* Fondo gris claro para encabezados en impresión */
                 color: black; /* Texto negro */
                 font-weight: bold;
            }
            header, footer {
                color: black; /* Asegurar texto negro en cabecera/pie */
            }
            h1, h2, p {
                color: black !important; /* Forzar color negro */
            }
            img {
                /* Ocultar imagen del sello en impresión si se desea */
                 display: none;
                /* O comentar la línea anterior para mostrarla */
            }
        }
    </style>
</head>
<body class="bg-radial-gradient-blue-yellow text-gray-800 flex flex-col items-center p-4 md:p-8">

    <div class="bg-white bg-opacity-80 p-6 md:p-10 rounded-lg shadow-xl w-full max-w-5xl backdrop-blur-sm printable-content">

        <header id="encabezadoNomina" class="text-center mb-8 relative">
             <img src="sello.jpg"
                  alt="Sello Unidad Educativa Dr. Camilo Gallegos Domínguez"
                  class="w-20 h-20 md:w-24 md:h-24 mx-auto mb-4 rounded-full shadow-md no-print"
                  onerror="this.onerror=null; this.src='https://placehold.co/100x100/cccccc/333333?text=Error+Sello';"
                  >
            <h1 class="text-2xl md:text-3xl font-bold text-blue-700">Unidad Educativa "Dr. Camilo Gallegos Domínguez"</h1>
            <p class="text-lg md:text-xl font-semibold text-blue-600 mt-2">Tercero Bachillerato Técnico - Informática "B"</p>
            <p class="text-md md:text-lg text-gray-700 mt-1">Tutora: Mgs. Maricela Cun Rueda</p>
            <p class="text-md md:text-lg text-gray-600">Año Lectivo: 2025-2026</p>
             <p class="mt-4 text-lg italic text-indigo-600 no-print">"La educación es el arma más poderosa que puedes usar para cambiar el mundo." - Nelson Mandela</p>
        </header>

        <div class="overflow-x-auto">
            <table id="tablaEstudiantes" class="min-w-full bg-white">
                <thead>
                    <tr>
                        <th class="px-4 py-2">No</th>
                        <th class="px-4 py-2">CÉDULA</th>
                        <th class="px-4 py-2">NOMBRES COMPLETOS</th>
                        <th class="px-4 py-2">CUENTA ESTUDIANTE</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td>0751030768</td><td>AGILA GUTIERREZ BRITTANY PAOLA</td><td>aggubrpa2768194@estudiantes2.edu.ec</td></tr>
                    <tr><td>2</td><td>0706833860</td><td>CAJAMARCA PEÑAFIEL DARWIN ALEXANDER</td><td>capedaal1645136@estudiantes2.edu.ec</td></tr>
                    <tr><td>3</td><td>0706078102</td><td>CAMACHO RODRIGUEZ LUZ MARIA</td><td>caroluma2754108@estudiantes2.edu.ec</td></tr>
                    <tr><td>4</td><td>0706864352</td><td>CASTILLO SARITAMA LUIS ALEXANDER</td><td>casalual1720789@estudiantes2.edu.ec</td></tr>
                    <tr><td>5</td><td>2101073233</td><td>CRUZ VELASCO STEFANIE YULIANA</td><td>crvestyu146723@estudiantes2.edu.ec</td></tr>
                    <tr><td>6</td><td>0706824703</td><td>CUENCA CALVA YUSELLY DAYANNA</td><td>cucayuda3884104@estudiantes2.edu.ec</td></tr>
                    <tr><td>7</td><td>0930915236</td><td>ESPINOZA AREVALO ERICKA DAYANNA</td><td>esarerda14200578@estudiantes2.edu.ec</td></tr>
                    <tr><td>8</td><td>0750144529</td><td>GUARNIZO SARANGO XIOMARA PAULETTE</td><td>gusaxipa2757739@estudiantes2.edu.ec</td></tr>
                    <tr><td>9</td><td>0956564660</td><td>GUTIERREZ RAMON AXEL XAVIER</td><td>quraaxxa4393457@estudiantes2.edu.ec</td></tr>
                    <tr><td>10</td><td>0750696049</td><td>JARAMILLO MORALES XIMENA KAROLINA</td><td>jamoxika1779104@estudiantes2.edu.ec</td></tr>
                    <tr><td>11</td><td>0706960747</td><td>JUMBO SARANGO JEFFERSON VICENTE</td><td>jusajevi1969273@estudiantes2.edu.ec</td></tr>
                    <tr><td>12</td><td>0706963691</td><td>LIANG FAREZ BAO YU</td><td>lifabayu4790870@estudiantes2.edu.ec</td></tr>
                    <tr><td>13</td><td>0706807732</td><td>MANZANO RAMIREZ GABRIELA ALEXANDRA</td><td>maragaal2696402@estudiantes2.edu.ec</td></tr>
                    <tr><td>14</td><td>0750058927</td><td>MASAPANTA FLORES VICTOR MANUEL</td><td>mativima1697099@estudiantes2.edu.ec</td></tr>
                    <tr><td>15</td><td>0706267382</td><td>MAZA CHUYA EMILY GABRIELA</td><td>machemga13143921@estudiantes2.edu.ec</td></tr>
                    <tr><td>16</td><td>1105444507</td><td>MEDINA SANCHEZ CRISTOPHER ADRIAN</td><td>mesacrad1784460@estudiantes2.edu.ec</td></tr>
                    <tr><td>17</td><td>0750227084</td><td>MENDOZA MANZANO KEVIN MANUEL</td><td>memakema2673416@estudiantes2.edu.ec</td></tr>
                    <tr><td>18</td><td>1752533370</td><td>MOROCHO VILLALTA ESTEFANY MARIBEL</td><td>moviesma11211481@estudiantes2.edu.ec</td></tr>
                    <tr><td>19</td><td>1752533701</td><td>MOROCHO VILLALTA JOSE ALEXANDER</td><td>movijoal11211538@estudiantes2.edu.ec</td></tr>
                    <tr><td>20</td><td>0750375289</td><td>NAZARENO NAZARENO ALEXANDRA NOEMI</td><td>nanaalno3895337@estudiantes2.edu.ec</td></tr>
                    <tr><td>21</td><td>1251384978</td><td>ORDOÑEZ BELTRAN ANGELA EUNICE</td><td>orbeaneu9150365@estudiantes2.edu.ec</td></tr>
                    <tr><td>22</td><td>0750554305</td><td>ORELLANA NOBLECILLA JEINER JAIR</td><td>ornojeja1720604@estudiantes2.edu.ec</td></tr>
                    <tr><td>23</td><td>0750831026</td><td>REYES BEDOYA MARIA ISABEL</td><td>rebemais12550177@estudiantes2.edu.ec</td></tr>
                    <tr><td>24</td><td>0706622370</td><td>RODRIGUEZ ROMERO ELVIS DANIEL</td><td>roroelda1828100@estudiantes2.edu.ec</td></tr>
                    <tr><td>25</td><td>0750046922</td><td>ROMERO JIMENEZ GRACIELA MERCEDES</td><td>rojigrme1643197@estudiantes2.edu.ec</td></tr>
                    <tr><td>26</td><td>0750699886</td><td>SANCHEZ ORDOÑEZ FELIX ADOLFO</td><td>saorfead1721668@estudiantes2.edu.ec</td></tr>
                    <tr><td>27</td><td>0750536757</td><td>SARANGO NARVAEZ DILAN JOSUE</td><td>sanadijo2495134@estudiantes2.edu.ec</td></tr>
                    <tr><td>28</td><td>0750924565</td><td>SOTO PUCHA ESNEIDER ANDRES</td><td>soan14937875@estudiantes2.edu.ec</td></tr>
                    <tr><td>29</td><td>0750844888</td><td>VINCES BRAVO ARIEL ENRIQUE</td><td>vibraren1896293@estudiantes2.edu.ec</td></tr>
                    <tr><td>30</td><td>0750585408</td><td>VIVANCO GRANDA ANTHONY JAIR</td><td>vigranja2519472@estudiantes2.edu.ec</td></tr>
                </tbody>
            </table>
        </div>

        <div class="text-center mt-8 no-print">
            <button id="btnDescargarExcel" class="btn btn-excel">
                Descargar Excel
            </button>
            <button id="btnImprimir" class="btn btn-print">
                Imprimir Nómina
            </button>
        </div>

        <footer class="text-center mt-8 text-sm text-gray-600">
            <p>Transformar la educación, misión de TODOS</p>
            <p>&copy; <span id="year"></span> Unidad Educativa "Dr. Camilo Gallegos Domínguez". Todos los derechos reservados.</p>
        </footer>

    </div>

    <script>
        // Establecer el año actual en el pie de página
        document.getElementById('year').textContent = new Date().getFullYear();

        // Funcionalidad del botón Imprimir (sin cambios)
        const btnImprimir = document.getElementById('btnImprimir');
        btnImprimir.addEventListener('click', () => {
            window.print(); // Abre el diálogo de impresión del navegador
        });

        // --- Funcionalidad del botón Descargar Excel (NUEVO) ---
        const btnDescargarExcel = document.getElementById('btnDescargarExcel');
        btnDescargarExcel.addEventListener('click', () => {
            try {
                // 1. Obtener datos del encabezado HTML
                const headerDiv = document.getElementById('encabezadoNomina');
                const institucion = headerDiv.querySelector('h1').innerText;
                const curso = headerDiv.querySelectorAll('p')[0].innerText; // Primer <p>
                const tutora = headerDiv.querySelectorAll('p')[1].innerText; // Segundo <p>
                const anioLectivo = headerDiv.querySelectorAll('p')[2].innerText; // Tercer <p>

                // 2. Preparar datos del encabezado para Excel
                const headerData = [
                    [institucion], // Fila 1
                    [curso],       // Fila 2
                    [tutora],      // Fila 3
                    [anioLectivo], // Fila 4
                    [] // Fila 5 (en blanco para separar)
                ];

                // 3. Obtener datos de la tabla HTML
                const table = document.getElementById('tablaEstudiantes');
                const tableHeaders = Array.from(table.querySelectorAll('thead th')).map(th => th.innerText);
                const tableBody = Array.from(table.querySelectorAll('tbody tr')).map(tr => {
                    return Array.from(tr.querySelectorAll('td')).map(td => td.innerText);
                });

                // 4. Combinar encabezado y tabla para la hoja de cálculo
                // Se añade primero el headerData, luego los encabezados de la tabla, y finalmente el cuerpo de la tabla
                const sheetData = headerData.concat([tableHeaders], tableBody);

                // 5. Crear la hoja de cálculo (worksheet)
                const ws = XLSX.utils.aoa_to_sheet(sheetData);

                // 6. Ajustar anchos de columna (aproximado, en caracteres)
                // 'No', 'CÉDULA', 'NOMBRES COMPLETOS', 'CUENTA ESTUDIANTE'
                ws['!cols'] = [
                    { wch: 5 },  // No
                    { wch: 15 }, // CÉDULA
                    { wch: 45 }, // NOMBRES COMPLETOS (más ancho)
                    { wch: 40 }  // CUENTA ESTUDIANTE
                ];

                // 7. Combinar celdas para los títulos del encabezado
                // Combinar las 4 columnas (A a D) para cada línea del encabezado
                ws['!merges'] = [
                    { s: { r: 0, c: 0 }, e: { r: 0, c: 3 } }, // Institución (Fila 1, Col A-D)
                    { s: { r: 1, c: 0 }, e: { r: 1, c: 3 } }, // Curso (Fila 2, Col A-D)
                    { s: { r: 2, c: 0 }, e: { r: 2, c: 3 } }, // Tutora (Fila 3, Col A-D)
                    { s: { r: 3, c: 0 }, e: { r: 3, c: 3 } }  // Año Lectivo (Fila 4, Col A-D)
                ];

                // Opcional: Centrar texto en las celdas combinadas del encabezado (requiere más formato)
                // Esto es más complejo con aoa_to_sheet, se puede hacer celda por celda si es necesario.

                // 8. Crear el libro de trabajo (workbook)
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Nómina'); // Nombrar la hoja 'Nómina'

                // 9. Generar y descargar el archivo Excel
                XLSX.writeFile(wb, 'Nomina_Tercero_Informatica_B.xlsx');

            } catch (error) {
                console.error("Error al generar el archivo Excel:", error);
                // Mostrar mensaje de error al usuario (usando un div temporal)
                const messageBox = document.createElement('div');
                messageBox.textContent = "Error al generar el Excel. Por favor, inténtalo de nuevo.";
                // (Estilos del messageBox como en el ejemplo anterior)
                messageBox.style.position = 'fixed';
                messageBox.style.top = '20px';
                messageBox.style.left = '50%';
                messageBox.style.transform = 'translateX(-50%)';
                messageBox.style.padding = '10px 20px';
                messageBox.style.backgroundColor = '#f8d7da';
                messageBox.style.color = '#721c24';
                messageBox.style.border = '1px solid #f5c6cb';
                messageBox.style.borderRadius = '8px';
                messageBox.style.zIndex = '1000';
                document.body.appendChild(messageBox);
                setTimeout(() => {
                    if (document.body.contains(messageBox)) {
                         document.body.removeChild(messageBox);
                    }
                }, 3000);
            }
        });
    </script>

</body>
</html>
